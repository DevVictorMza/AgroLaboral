<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="Content-Security-Policy" content="default-src 'self' https: data: 'unsafe-inline' 'unsafe-eval'; script-src 'self' https: 'unsafe-inline' 'unsafe-eval'; style-src 'self' https: 'unsafe-inline'; font-src 'self' https: data:; img-src 'self' https: data: blob:; connect-src 'self' https: http://localhost:8080 http://localhost:5501 http://localhost:3001 ws://localhost:*;">
  <title>Agro Lab's - Mendoza</title>
    <!-- Page Wrapper CSS - DEBE IR PRIMERO -->
    <link rel="stylesheet" href="css/page-wrapper.css?v=agro-claro-unificado">
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <!-- FontAwesome CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Custom CSS -->
    <link rel="stylesheet" href="css/style.css?v=sin-cuadro-h2-vino">
    <link rel="stylesheet" href="css/dashboard-extra.css?v=no-green-hover">
    <link rel="stylesheet" href="css/botones-gigantes.css?v=1">
    <link rel="stylesheet" href="css/map-ofertas.css?v=1">
    <link rel="stylesheet" href="css/map-establecimientos.css?v=badge-blanco">
    <link rel="stylesheet" href="css/marcador-destacado.css">
    <link rel="stylesheet" href="css/map-markers.css?v=1">
    <link rel="stylesheet" href="css/ofertas-section.css?v=filtros-vino-5F021C">
    <!-- Ofertas Cards Modernas CSS -->
    <link rel="stylesheet" href="css/ofertas-cards.css?v=1">
    <!-- Detalles de Ubicación CSS -->
    <link rel="stylesheet" href="css/detalles-ubicacion.css?v=1">
    <!-- Stats Cards CSS -->
    <link rel="stylesheet" href="css/stats-cards.css?v=1">
    <!-- Controles Modernos del Mapa CSS -->
    <link rel="stylesheet" href="css/map-controls.css?v=1">
    <!-- Layout Responsive CSS -->
    <link rel="stylesheet" href="css/layout-responsive.css?v=1">
    <!-- Wizard Finca CSS -->
    <link rel="stylesheet" href="css/wizard-finca.css?v=1">
    <!-- Lista de Establecimientos CSS -->
    <link rel="stylesheet" href="css/establecimientos-lista.css?v=1">
    <!-- Cards CSS - MODALES -->
    <link rel="stylesheet" href="css/cards-modales.css?v=2">
    <!-- Sistema de Postulaciones CSS -->
    <link rel="stylesheet" href="css/postulaciones.css?v=1">
    <!-- Carrusel de Servicios Agrícolas CSS -->
    <link rel="stylesheet" href="css/servicios-carousel-agro.css?v=agro-claro-unificado">
    <!-- Tema Morado Uva - Mapa Interactivo CSS -->
    <link rel="stylesheet" href="css/mapa-uva-theme.css?v=vino-total-5F021C">
    <!-- Profile Empresarial CSS - ÚLTIMO PARA MÁXIMA PRIORIDAD -->
    <link rel="stylesheet" href="css/profile-empresarial.css?v=2E2517">
    
    <!-- Estilos mínimos inline para optimización -->
    <style>
        /* Forzar X blanca en btn-close-white */
        .btn-close.btn-close-white {
            filter: invert(1) grayscale(100%) brightness(200%) !important;
            opacity: 1 !important;
            background-color: transparent !important;
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16' fill='%23fff'%3e%3cpath d='M.293.293a1 1 0 0 1 1.414 0L8 6.586 14.293.293a1 1 0 1 1 1.414 1.414L9.414 8l6.293 6.293a1 1 0 0 1-1.414 1.414L8 9.414l-6.293 6.293a1 1 0 0 1-1.414-1.414L6.586 8 .293 1.707a1 1 0 0 1 0-1.414z'/%3e%3c/svg%3e") !important;
        }
        
        /* Offcanvas dashboard styles */
        .establecimientos-container .establecimiento-card .dropdown-item.text-danger:hover {
            background: rgba(231, 76, 60, 0.15) !important;
            color: #ff6b6b !important;
        }
        
        /* BADGE PROFESIONAL */
        .dashboard-card .establecimiento-card .badge.bg-success,
        .establecimientos-container .establecimiento-card .badge.bg-success {
            background: linear-gradient(135deg, #27AE60, #2ECC71) !important;
            box-shadow: 0 2px 4px rgba(39, 174, 96, 0.3) !important;
            border-radius: 20px !important;
        }
        
        .offcanvas.offcanvas-end {
            --bs-offcanvas-width: 90%;
            max-width: 800px;
        }
        
        .bg-black {
            background-color: #000000 !important;
        }
        
        /* ============================================= */
        /* CONTENEDOR ESPECIES - FONDO #181101 FORZADO  */
        /* ============================================= */
        .especies-collapse-container,
        div.especies-collapse-container,
        #wizardFincaModal .especies-collapse-container,
        #wizardFincaModal .modal-body .especies-collapse-container,
        #wizardFincaModal .modal-content .especies-collapse-container,
        #especiesCollapse .especies-collapse-container,
        .collapse .especies-collapse-container,
        [class*="especies-collapse-container"] {
            background: #181101 !important;
            background-color: #181101 !important;
            border: 1px solid #444 !important;
            border-radius: 8px !important;
        }
        
        /* Tarjetas de especies dentro del contenedor */
        .especies-collapse-container .especie-card,
        #wizardFincaModal .especie-card {
            background: #2E2517 !important;
            background-color: #2E2517 !important;
            border: 2px solid #555 !important;
        }
        
        .especies-collapse-container .especie-card:hover,
        #wizardFincaModal .especie-card:hover {
            background: #3D3220 !important;
            border-color: #777 !important;
        }
        
        .especies-collapse-container .especie-card.selected,
        #wizardFincaModal .especie-card.selected {
            background: rgba(40, 167, 69, 0.25) !important;
            border-color: #28a745 !important;
        }
        
        /* Botón selector de especies */
        .especies-collapse-btn,
        #especiesSelector,
        #wizardFincaModal .especies-collapse-btn {
            background: #181101 !important;
            background-color: #181101 !important;
        }
        
        .especies-collapse-btn:hover,
        #especiesSelector:hover {
            background: #181101 !important;
            background-color: #181101 !important;
        }
        
        /* ============================================= */
        /* INPUTS WIZARD FINCA - FONDO MARRÓN #181101   */
        /* ============================================= */
        #wizardFincaModal .form-control,
        #wizardFincaModal .form-select,
        #wizardFincaModal input,
        #wizardFincaModal select,
        #wizardFincaModal textarea,
        #wizardFincaModal .bg-secondary,
        #wizardFincaModal .bg-dark {
            background: #181101 !important;
            background-color: #181101 !important;
            color: #FFFFFF !important;
            border-color: #444 !important;
        }
        
        #wizardFincaModal .form-control:focus,
        #wizardFincaModal .form-select:focus,
        #wizardFincaModal input:focus,
        #wizardFincaModal select:focus,
        #wizardFincaModal textarea:focus {
            background: #181101 !important;
            background-color: #181101 !important;
            border-color: #666 !important;
            box-shadow: 0 0 0 0.2rem rgba(24, 17, 1, 0.5) !important;
        }
        
        #wizardFincaModal .form-control::placeholder,
        #wizardFincaModal input::placeholder {
            color: #999 !important;
        }
        
        /* FORZAR inputs con ID específico */
        #nombreEstablecimiento,
        #idDepartamento,
        #idDistrito,
        #calle,
        #numeracion,
        #codigoPostal,
        #longitud,
        #latitud,
        #finca-form input,
        #finca-form select,
        #finca-form .form-control,
        #finca-form .form-select {
            background: #181101 !important;
            background-color: #181101 !important;
            color: #FFFFFF !important;
        }
        
        /* Options en selects */
        #wizardFincaModal option,
        #finca-form option {
            background: #181101 !important;
            background-color: #181101 !important;
            color: #FFFFFF !important;
        }
        
        /* ESPACIADO INTERNO DEL WIZARD MODAL */
        #wizardFincaModal .modal-body {
            padding: 2.5rem 3rem !important;
        }
        
        #wizardFincaModal #wizard-content {
            max-width: 95% !important;
            margin: 0 auto !important;
            padding: 0 1rem !important;
        }
        
        #wizardFincaModal #finca-form {
            padding: 0 1.5rem !important;
        }
        
        #wizardFincaModal #finca-form .row {
            margin-left: 0 !important;
            margin-right: 0 !important;
        }
        
        #wizardFincaModal #finca-form .col-12,
        #wizardFincaModal #finca-form .col-md-4,
        #wizardFincaModal #finca-form .col-md-6,
        #wizardFincaModal #finca-form .col-md-8 {
            padding-left: 0.75rem !important;
            padding-right: 0.75rem !important;
        }
        
        /* Ocultar validación hasta que el usuario interactúe */
        #wizardFincaModal .form-control:not(.was-validated):not(.touched),
        #wizardFincaModal .form-select:not(.was-validated):not(.touched) {
            border-color: #444 !important;
        }
        
        #wizardFincaModal .form-control:not(.touched) + .field-feedback,
        #wizardFincaModal .form-control:not(.touched) + .invalid-feedback {
            display: none !important;
        }
        
        /* Solo mostrar is-invalid después de interacción */
        #wizardFincaModal .form-control:not(.touched).is-invalid,
        #wizardFincaModal .form-select:not(.touched).is-invalid {
            border-color: #444 !important;
            background-image: none !important;
        }
        
        /* ============================================= */
        /* POPUP MAPA WIZARD FINCA - FONDO NEGRO        */
        /* ============================================= */
        .popup-wizard-finca-custom .leaflet-popup-content-wrapper,
        .leaflet-popup.popup-wizard-finca-custom .leaflet-popup-content-wrapper {
            background: #000000 !important;
            background-color: #000000 !important;
            color: #FFFFFF !important;
            border-radius: 10px !important;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.6) !important;
            border: 1px solid #333 !important;
        }
        
        .popup-wizard-finca-custom .leaflet-popup-content,
        .leaflet-popup.popup-wizard-finca-custom .leaflet-popup-content {
            margin: 0 !important;
            padding: 0 !important;
            color: #FFFFFF !important;
        }
        
        .popup-wizard-finca-custom .leaflet-popup-tip,
        .leaflet-popup.popup-wizard-finca-custom .leaflet-popup-tip {
            background: #000000 !important;
            border: none !important;
        }
        
        .popup-wizard-finca-custom .leaflet-popup-close-button,
        .leaflet-popup.popup-wizard-finca-custom .leaflet-popup-close-button {
            color: #FFFFFF !important;
            font-size: 20px !important;
            padding: 5px 8px !important;
        }
        
        .popup-wizard-finca-custom .leaflet-popup-close-button:hover {
            color: #28a745 !important;
        }
        
        .popup-ubicacion-wizard,
        .popup-ubicacion-wizard * {
            background: #000000 !important;
            color: #FFFFFF !important;
        }
        /* ============================================= */
        
        /* ============================================= */
        
        /* FONDO PRINCIPAL MARRÓN OSCURO - FORZADO */
        html, body, #page-wrapper {
            background: #4B382A !important;
            background-color: #4B382A !important;
        }
        
        /* Forzar todos los contenedores principales */
        .container-fluid, main, section {
            background: transparent !important;
        }
        
        /* Sobrescribir cualquier otro fondo */
        body::before, body::after {
            display: none !important;
        }
        
        /* DASHBOARD MODAL FULLSCREEN ESTILOS PROFESIONALES */
        #dashboardOffcanvas {
            z-index: 1060 !important;
        }
        
        /* MODAL CON 60% DE ANCHO */
        #dashboardOffcanvas.modal {
            padding: 0 !important;
        }
        
        #dashboardOffcanvas .modal-dialog {
            width: 60vw !important;
            height: 100vh !important;
            margin: 0 auto !important;
            padding: 0 !important;
            max-width: 60vw !important;
            max-height: none !important;
            border-radius: 0 !important;
        }
        
        #dashboardOffcanvas .modal-fullscreen {
            width: 60vw !important;
            height: 100vh !important;
            margin: 0 auto !important;
            padding: 0 !important;
            border-radius: 0 !important;
            max-width: 60vw !important;
            max-height: 100vh !important;
        }
        
        #dashboardOffcanvas .modal-content {
            width: 60vw !important;
            height: 100vh !important;
            border: none !important;
            border-radius: 0 !important;
            background: #428F61 !important;
            overflow: hidden !important;
        }
        
        #dashboardOffcanvas .modal-header {
            background: linear-gradient(135deg, #4A90E2 0%, #357ABD 50%, #2c5aa0 100%) !important;
            border-bottom: 2px solid #4A90E2 !important;
            padding: 1.5rem 2rem !important;
            box-shadow: 0 4px 15px rgba(74, 144, 226, 0.3) !important;
        }
        
        #dashboardOffcanvas .modal-title {
            font-size: 1.75rem !important;
            font-weight: 700 !important;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3) !important;
        }
        
        #dashboardOffcanvas .modal-body {
            padding: 0 !important;
            height: calc(100vh - 80px) !important;
            overflow-y: auto !important;
            background: #004225 !important;
        }
        
        #dashboardOffcanvas .dashboard-container {
            padding: 2rem !important;
            min-height: calc(100vh - 80px) !important;
            background: #004225 !important;
        }
        
        /* ASEGURAR QUE EL MODAL CUBRA TODA LA PANTALLA */
        body.modal-open {
            overflow: hidden !important;
            padding-right: 0 !important;
        }
        
        #dashboardOffcanvas.show {
            display: block !important;
            position: fixed !important;
            top: 0 !important;
            left: 0 !important;
            width: 100vw !important;
            height: 100vh !important;
            z-index: 1060 !important;
        }
        
        #dashboardOffcanvas .modal-backdrop {
            display: none !important;
        }
        
        /* ESTILOS ADICIONALES PARA ASEGURAR COBERTURA COMPLETA */
        #dashboardOffcanvas.modal.show .modal-dialog {
            position: fixed !important;
            top: 0 !important;
            left: 20vw !important;
            width: 60vw !important;
            height: 100vh !important;
            transform: none !important;
        }
        
        /* OVERRIDE AGRESIVO PARA BOOTSTRAP MODAL-FULLSCREEN */
        #dashboardOffcanvas.modal .modal-dialog.modal-fullscreen {
            width: 60vw !important;
            height: 100vh !important;
            max-width: 60vw !important;
            max-height: 100vh !important;
            margin: 0 auto !important;
            padding: 0 !important;
            left: 20vw !important;
            position: fixed !important;
        }
        
        #dashboardOffcanvas.modal .modal-dialog.modal-fullscreen .modal-content {
            width: 60vw !important;
            height: 100vh !important;
            max-width: 60vw !important;
            max-height: 100vh !important;
            border: none !important;
            border-radius: 0 !important;
            margin: 0 !important;
            padding: 0 !important;
        }
        
        /* FORZAR POSICIONAMIENTO Y TAMAÑO */
        #dashboardOffcanvas {
            position: fixed !important;
            top: 0 !important;
            left: 0 !important;
            width: 100vw !important;
            height: 100vh !important;
            padding: 0 !important;
            margin: 0 !important;
        }
        
        /* OVERRIDE COMPLETO DE BOOTSTRAP MODAL */
        .modal.fade#dashboardOffcanvas {
            --bs-modal-width: 100vw !important;
            --bs-modal-height: 100vh !important;
            --bs-modal-margin: 0 !important;
            --bs-modal-border-width: 0 !important;
            --bs-modal-border-radius: 0 !important;
        }
        
        /* LOADING STATE MEJORADO */
        #dashboardOffcanvas .loading-container {
            min-height: 60vh !important;
        }
        
        #dashboardOffcanvas .loading-container .spinner-border {
            width: 3rem !important;
            height: 3rem !important;
            border-width: 0.3em !important;
        }
        
        /* RESPONSIVE PARA EL MODAL */
        @media (max-width: 768px) {
            #dashboardOffcanvas .modal-header {
                padding: 1rem !important;
            }
            
            #dashboardOffcanvas .modal-title {
                font-size: 1.5rem !important;
            }
            
            #dashboardOffcanvas .dashboard-container {
                padding: 1rem !important;
            }
        }
        
        /* ANIMACIONES SUAVES PARA EL MODAL */
        #dashboardOffcanvas.show .modal-dialog {
            animation: dashboardFadeIn 0.3s ease-out !important;
        }
        
        @keyframes dashboardFadeIn {
            from {
                opacity: 0;
                transform: scale(0.95);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }
        
        /* MEJORAS PARA CARDS EN MODAL FULLSCREEN */
        #dashboardOffcanvas .dashboard-card {
            background: var(--card-bg-primary) !important;
            border: 1px solid var(--card-border) !important;
            border-radius: 12px !important;
            box-shadow: var(--card-shadow-default) !important;
            transition: all var(--transition-smooth) !important;
        }
        
        #dashboardOffcanvas .dashboard-card:hover {
            border-color: var(--card-border-hover) !important;
            box-shadow: var(--card-shadow-hover) !important;
            transform: var(--btn-hover-transform) !important;
        }
        
        #dashboardOffcanvas .establecimiento-card {
            background: var(--card-bg-secondary) !important;
            border: 1px solid var(--card-border) !important;
            border-radius: 10px !important;
            box-shadow: var(--card-shadow-default) !important;
            transition: all var(--transition-smooth) !important;
            margin-bottom: 1.5rem !important;
        }
        
        #dashboardOffcanvas .establecimiento-card:hover {
            border-color: var(--card-border-hover) !important;
            box-shadow: var(--card-shadow-hover) !important;
            transform: var(--btn-hover-transform) !important;
        }
        
        #dashboardOffcanvas .establecimiento-card .card-header {
            background: linear-gradient(135deg, var(--card-bg-primary), var(--card-bg-secondary)) !important;
            border-bottom: 1px solid var(--card-border) !important;
            border-radius: 10px 10px 0 0 !important;
            padding: 1rem 1.25rem !important;
        }
        
        #dashboardOffcanvas .establecimiento-card .card-footer {
            background: var(--card-bg-primary) !important;
            border-top: 1px solid var(--card-border) !important;
            border-radius: 0 0 10px 10px !important;
            padding: 1rem 1.25rem !important;
        }
        
        /* BOTONES MEJORADOS EN MODAL FULLSCREEN */
        #dashboardOffcanvas .btn-sm {
            padding: var(--btn-sm-padding) !important;
            font-size: var(--btn-sm-font-size) !important;
            border-radius: var(--btn-sm-border-radius) !important;
            font-weight: 500 !important;
            transition: all var(--transition-fast) !important;
        }
        
        #dashboardOffcanvas .btn-sm:hover {
            transform: var(--btn-hover-transform) !important;
        }
        
        #dashboardOffcanvas .btn-sm:active {
            transform: var(--btn-active-transform) !important;
        }
        
        /* DROPDOWNS MEJORADOS */
        #dashboardOffcanvas .dropdown-menu {
            background: var(--dropdown-bg) !important;
            border: 1px solid var(--dropdown-border) !important;
            border-radius: 8px !important;
            box-shadow: var(--dropdown-shadow) !important;
            animation: dropdownSlideIn 0.2s ease-out !important;
        }
        
        #dashboardOffcanvas .dropdown-item:hover {
            background: var(--dropdown-item-hover) !important;
            color: white !important;
        }
        
        @keyframes dropdownSlideIn {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        /* STATS CARDS MEJORADAS */
        #dashboardOffcanvas .stats-card {
            background: var(--card-bg-secondary) !important;
            border: 1px solid var(--card-border) !important;
            border-radius: 10px !important;
            box-shadow: var(--card-shadow-default) !important;
            transition: all var(--transition-smooth) !important;
            padding: 1.5rem !important;
        }
        
        #dashboardOffcanvas .stats-card:hover {
            border-color: var(--card-border-hover) !important;
            box-shadow: var(--card-shadow-hover) !important;
            transform: var(--btn-hover-transform) !important;
        }
        
        #dashboardOffcanvas .stats-number {
            font-size: 2.5rem !important;
            font-weight: 700 !important;
            color: var(--info-color) !important;
            text-shadow: 0 2px 4px rgba(52, 152, 219, 0.3) !important;
        }
        
        /* PROFILE HEADER MEJORADO */
        #dashboardOffcanvas .profile-header,
        #dashboardOffcanvas .profile-header-modern,
        .dashboard-container .profile-header-modern {
            background: #2E2517 !important;
            border: 2px solid rgba(46, 37, 23, 0.8) !important;
            border-radius: 16px !important;
            box-shadow: 0 8px 24px rgba(46, 37, 23, 0.4) !important;
            padding: 0 !important;
            margin-bottom: 2rem !important;
        }
        
        #dashboardOffcanvas .profile-content,
        .dashboard-container .profile-content {
            background: transparent !important;
            padding: 2rem !important;
        }
        
        #dashboardOffcanvas .profile-backdrop,
        .dashboard-container .profile-backdrop {
            background: linear-gradient(135deg, rgba(46, 37, 23, 0.3) 0%, rgba(46, 37, 23, 0.2) 100%) !important;
        }
        
        /* DASHBOARD CARDS - GESTIÓN DE FINCAS */
        #dashboardOffcanvas .dashboard-card,
        .dashboard-container .dashboard-card {
            background: #2E2517 !important;
            border: 2px solid rgba(46, 37, 23, 0.8) !important;
            border-radius: 12px !important;
            box-shadow: 0 8px 24px rgba(46, 37, 23, 0.4) !important;
        }
        
        #dashboardOffcanvas .dashboard-card:hover {
            box-shadow: 0 12px 32px rgba(46, 37, 23, 0.6) !important;
        }
        
        /* MODALES - COLOR VERDE #428F61 */
        .modal-content,
        .modal .modal-content,
        .modal-dialog .modal-content {
            background: #428F61 !important;
            border: 2px solid rgba(66, 143, 97, 0.8) !important;
            box-shadow: 0 8px 32px rgba(66, 143, 97, 0.4) !important;
            color: #FFFFFF !important;
        }
        
        .modal-content.bg-dark,
        .modal-content.bg-black,
        #dashboardOffcanvas .modal-content.bg-black,
        #dashboardOffcanvas .modal-content,
        .modal-dialog .modal-content.bg-black {
            background: #428F61 !important;
            border: 2px solid rgba(66, 143, 97, 0.8) !important;
            box-shadow: 0 8px 32px rgba(66, 143, 97, 0.4) !important;
        }
        
        #dashboardOffcanvas .modal-body.bg-black,
        #dashboardOffcanvas .modal-body {
            background: transparent !important;
        }
        
        .modal-header {
            background: rgba(66, 143, 97, 0.2) !important;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2) !important;
        }
        
        .modal-footer {
            background: rgba(66, 143, 97, 0.2) !important;
            border-top: 1px solid rgba(255, 255, 255, 0.2) !important;
        }
        
        /* TARJETA MAPA INTERACTIVO - COLOR BORGOÑA #5F021C */
        .servicio-card-mapa,
        .servicio-card-mapa-uva {
            background: #5F021C !important;
            border: 2px solid rgba(95, 2, 28, 0.8) !important;
            box-shadow: none !important;
        }
        
        .servicio-card-mapa .card-body,
        .servicio-card-mapa-uva .card-body {
            background: transparent !important;
            color: #FFFFFF !important;
        }
        
        .servicio-card-mapa h2,
        .servicio-card-mapa-uva h2 {
            color: #FFFFFF !important;
        }
        
        /* TARJETA OFERTAS DISPONIBLES - COLOR BORGOÑA #5F021C */
        .servicio-card-ofertas {
            background: linear-gradient(145deg, #5F021C 0%, #8B0329 25%, #A0173A 50%, #8B0329 75%, #4A0115 100%) !important;
            border: 2px solid rgba(95, 2, 28, 0.8) !important;
            box-shadow: none !important;
        }
        
        .servicio-card-ofertas .card-body {
            background: transparent !important;
            color: #FFFFFF !important;
        }
        
        .servicio-card-ofertas h2,
        .servicio-card-ofertas p {
            color: #FFFFFF !important;
        }
        
        .servicio-icon-ofertas {
            color: #FFD700 !important;
        }
        
        .servicio-card-ofertas .badge {
            background: linear-gradient(135deg, #FFD700 0%, #FFA500 100%) !important;
            color: #4A0115 !important;
        }
        
        /* Proteger tarjetas marrones dentro de modales */
        .modal-content .dashboard-card,
        .modal-content .profile-header-modern {
            background: #2E2517 !important;
        }
        
        /* RESPONSIVE ADICIONAL PARA MODAL */
        @media (max-width: 768px) {
            #dashboardOffcanvas .establecimiento-card {
                margin-bottom: 1rem !important;
            }
            
            #dashboardOffcanvas .stats-card {
                padding: 1rem !important;
            }
            
            #dashboardOffcanvas .stats-number {
                font-size: 2rem !important;
            }
        }
        
        .toast-container {
            z-index: 1070;
        }
        
        /* CORRECCIÓN CRÍTICA: Z-index para modals */
        .modal {
            z-index: 1055 !important;
        }
        
        .modal-backdrop {
            z-index: 1050 !important;
        }
        
        /* CRÍTICO: El backdrop NO debe bloquear eventos dentro del modal */
        .modal-backdrop {
            pointer-events: none !important;
        }
        
        /* CRÍTICO: El modal SÍ debe recibir eventos */
        .modal-dialog {
            pointer-events: auto !important;
            z-index: 1056 !important;
            position: relative !important;
        }
        
        /* Asegurar interactividad TOTAL de inputs en modal */
        .modal input, 
        .modal select, 
        .modal textarea, 
        .modal button {
            pointer-events: auto !important;
            position: relative !important;
            z-index: 1057 !important;
        }
        
        .finca-card {
            transition: all 0.3s ease;
            background: #2A2A2A;
        }
        
        .finca-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.3);
        }
        
        /* Estilos para formularios del wizard */
        .form-control:focus, .form-select:focus {
            border-color: #4A90E2;
            box-shadow: 0 0 0 0.2rem rgba(74, 144, 226, 0.25);
        }
        
        .btn-primary-custom:focus {
            box-shadow: 0 0 0 0.2rem rgba(74, 144, 226, 0.5);
        }
        
        /* Animaciones suaves */
        .dashboard-card, .stats-card, .confirmation-card {
            transition: all 0.3s ease;
        }
        
        .dashboard-card:hover, .stats-card:hover {
            transform: translateY(-2px);
        }
        
        /* =============================================
           MODAL POSTULACIÓN - FONDO #004225
           ============================================= */
        #modalPostulacion .modal-content,
        #modalPostulacion .modal-content.bg-dark {
            background: #004225 !important;
            background-color: #004225 !important;
            border: 2px solid #006837 !important;
            box-shadow: 0 8px 32px rgba(0, 66, 37, 0.5) !important;
        }
        
        #modalPostulacion .modal-header {
            background: #004225 !important;
            background-color: #004225 !important;
            border-bottom: 1px solid #006837 !important;
        }
        
        #modalPostulacion .modal-body {
            background: #004225 !important;
            background-color: #004225 !important;
        }
        
        #modalPostulacion .modal-footer {
            background: #004225 !important;
            background-color: #004225 !important;
            border-top: 1px solid #006837 !important;
        }
        
        #modalPostulacion .form-control,
        #modalPostulacion .form-select {
            background: #181101 !important;
            background-color: #181101 !important;
            border: 1px solid #006837 !important;
            color: #FFFFFF !important;
        }
        
        #modalPostulacion .form-control:focus,
        #modalPostulacion .form-select:focus {
            background: #181101 !important;
            background-color: #181101 !important;
            border-color: #00A651 !important;
            box-shadow: 0 0 0 0.2rem rgba(0, 104, 55, 0.3) !important;
            color: #FFFFFF !important;
        }
        
        #modalPostulacion .form-control::placeholder {
            color: #AAAAAA !important;
        }
        
        #modalPostulacion .card {
            background: #003319 !important;
            border: 1px solid #006837 !important;
        }
        
        #modalPostulacion .card-header {
            background: #002815 !important;
            border-bottom: 1px solid #006837 !important;
        }
        
        /* OCULTAR COMPLETAMENTE invalid-feedback - solo mostrar con clase show-error */
        #modalPostulacion .invalid-feedback,
        #modalPostulacion .invalid-feedback.d-block,
        #form-postulacion .invalid-feedback,
        #form-postulacion .invalid-feedback.d-block {
            display: none !important;
            visibility: hidden !important;
            opacity: 0 !important;
            height: 0 !important;
            max-height: 0 !important;
            overflow: hidden !important;
            margin: 0 !important;
            padding: 0 !important;
            line-height: 0 !important;
            width: 0 !important;
            position: absolute !important;
            left: -9999px !important;
        }
        
        /* Solo mostrar cuando tiene la clase show-error */
        #modalPostulacion .invalid-feedback.show-error,
        #form-postulacion .invalid-feedback.show-error {
            display: block !important;
            visibility: visible !important;
            opacity: 1 !important;
            height: auto !important;
            max-height: none !important;
            width: auto !important;
            position: relative !important;
            left: 0 !important;
            color: #ff6b6b !important;
            font-size: 0.875rem !important;
            margin-top: 0.25rem !important;
            padding: 0 !important;
            line-height: 1.5 !important;
        }
        
        /* Ocultar tooltip de validación nativa del navegador */
        #form-postulacion input:invalid,
        #form-postulacion select:invalid {
            box-shadow: none !important;
        }
        
        #form-postulacion input::-webkit-validation-bubble,
        #form-postulacion input::-webkit-validation-bubble-message,
        #form-postulacion input::-webkit-validation-bubble-arrow,
        #form-postulacion input::-webkit-validation-bubble-arrow-clipper {
            display: none !important;
        }
    </style>
</head>
<body>
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-light fixed-top" id="transparent-navbar">
        <div class="container-fluid">
            <!-- Logo y texto eliminados de la navbar -->
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                    <li class="nav-item">
                        <a class="nav-link active" aria-current="page" href="#">Inicio</a>
                    </li>
                    <li class="nav-item">

                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#ofertas-disponibles">Ofertas</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#servicios-carousel">Nuestros servicios</a>
                    </li>
                </ul>
                <!-- Botones públicos (antes del registro) - Estilo nav-link -->
                <ul class="navbar-nav" id="public-buttons">
                    <li class="nav-item">
                        <a class="nav-link" href="#" id="btn-login" data-bs-toggle="modal" data-bs-target="#modalLogin" onclick="return false;">Ingresar a mi cuenta</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" data-bs-toggle="modal" data-bs-target="#modalRegistroEmpleador" id="btn-registro" onclick="return false;">Registro Empleador</a>
                    </li>
                </ul>
                <div class="d-flex">
                </div>
                    <!-- Modal se moverá fuera del nav -->
                    </div>
                </div>
            </div>
        </div>
                </div>
            </div>
        </div>
    </nav>
            <!-- Banner -->
    <!-- Modal Registro Empleador (Wizard) -->
    <div class="modal fade" id="modalRegistroEmpleador" tabindex="-1" aria-labelledby="modalRegistroEmpleadorLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header border-0 pb-0">
                    <h4 class="modal-title w-100 text-center fw-bold" id="modalRegistroEmpleadorLabel">Registro de Empleador</h4>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
                </div>
                <div class="modal-body pt-0">
                    <!-- Wizard Steps -->
                    <div class="wizard-progress mb-4">
                        <div class="progress wizard-progress-bar">
                            <div class="progress-bar wizard-progress-bar-inner" role="progressbar"></div>
                        </div>
                        <div class="wizard-steps-labels d-flex justify-content-between mt-2">
                            <div class="wizard-step-label active" data-step="0">
                                <span>1</span> 
                                <span>Datos<br>de Empresa</span>
                            </div>
                            <div class="wizard-step-label" data-step="1">
                                <span>2</span> 
                                <span>Confirmación</span>
                            </div>
                        </div>
                    </div>
                    <!-- Paso 1: Datos de empresa -->
                    <form id="form-registro-empleador-paso1">
                        <div class="mb-4">
                            <h5 class="fw-bold mb-3">Datos de Empresa</h5>
                            <div class="mb-3 position-relative">
                                <label for="cuit" class="form-label">CUIT</label>
                                <input type="text" class="form-control" id="cuit" name="cuit" placeholder="Ej: 20123456789">
                                <div class="char-counter">0/11</div>
                            </div>
                            <div class="mb-3 position-relative">
                                <label for="razonSocial" class="form-label">Razón Social</label>
                                <input type="text" class="form-control" id="razonSocial" name="razonSocial" placeholder="Ej: Finca Los Olivos">
                                <div class="char-counter">0/50</div>
                            </div>
                            <div class="mb-3 position-relative">
                                <label for="password" class="form-label">Contraseña</label>
                                <input type="password" class="form-control" id="password" name="password" placeholder="Ingrese contraseña (6 caracteres)" maxlength="6">
                                <div class="char-counter">0/6</div>
                            </div>
                            <div class="mb-3 position-relative">
                                <label for="password2" class="form-label">Repetir Contraseña</label>
                                <input type="password" class="form-control" id="password2" name="password2" placeholder="Repita la contraseña" maxlength="6">
                                <div class="char-counter">0/6</div>
                            </div>
                        </div>
                        <div class="d-flex justify-content-end">
                            <button type="button" class="btn btn-primary" id="btn-siguiente-paso1">Siguiente</button>
                        </div>
                    </form>
                    <!-- Paso 2: Confirmación (oculto por ahora) -->
                    <form id="form-registro-empleador-paso2" class="d-none">
                        <div id="mensaje-error-confirmacion" class="alert alert-danger d-none" role="alert">
                            Faltan datos obligatorios en el resumen. Por favor, revise los pasos anteriores.
                        </div>
                        <div class="mb-4">
                            <h5 class="fw-bold mb-3">Confirmación de Registro</h5>
                            <ul class="list-group mb-3" id="confirmacion-lista">
                                <!-- Los datos se llenarán por JS -->
                            </ul>
                            <div class="d-flex justify-content-between">
                                <button type="button" class="btn btn-outline-secondary" id="btn-anterior-paso5">Anterior</button>
                                <button type="submit" class="btn btn-success" id="btn-confirmar-registro">Confirmar Registro</button>
                            </div>
                            <div id="mensaje-exito" class="alert alert-success mt-4 d-none" role="alert">
                                ¡Su cuenta ha sido creada con éxito!
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Login -->
    <div class="modal fade" id="modalLogin" tabindex="-1" aria-labelledby="modalLoginLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header border-0 pb-0">
                    <h4 class="modal-title w-100 text-center fw-bold" id="modalLoginLabel">Iniciar Sesión</h4>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
                </div>
                <div class="modal-body pt-0">
                    <form id="form-login">
                        <div class="mb-4">
                            <div class="mb-3">
                                <label for="cuit-login" class="form-label">CUIT</label>
                                <input type="text" class="form-control" id="cuit-login" name="cuit-login" placeholder="Ej: 20123456789">
                            </div>
                            <div class="mb-3 position-relative">
                                <label for="password-login" class="form-label">Contraseña</label>
                                <input type="password" class="form-control" id="password-login" name="password-login" placeholder="Ingresa tu contraseña">
                            </div>
                            <div id="login-error" class="alert alert-danger d-none">
                                <i class="fas fa-exclamation-circle me-2"></i><span></span>
                            </div>
                        </div>
                        <div class="d-grid gap-2">
                            <button type="button" class="btn btn-primary btn-lg" id="btn-iniciar-sesion">
                                <i class="fas fa-sign-in-alt me-2"></i>Iniciar Sesión
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Main Page Wrapper -->
    <div id="page-wrapper">
    <div class="banner-container text-white d-flex align-items-center justify-content-center">
        <!-- Imagen de fondo -->
        <div class="banner-background-image"></div>
        
        <!-- Overlay para mejorar legibilidad del texto -->
        <div class="video-overlay"></div>
        
        <!-- Contenido del banner -->
        <div class="text-center banner-text-content">
            <!-- Ícono de uva eliminado -->
            <h1 class="display-4 fw-bold title-gradient animated-title">Bienvenidos a Agro Lab's</h1>
            <p class="lead subtitle-enhanced">El puente digital entre empleadores y trabajadores del agro.</p>
        </div>
    </div>
    
    <!-- Carrusel de Servicios Agrícolas -->
    <section id="servicios-carousel" aria-label="Nuestros Servicios Agrícolas">
        <div class="container-fluid">
            <!-- Header del Carrusel -->
            <div class="row justify-content-center mb-4">
                <div class="col-12">
                    <div class="servicio-header-card card-ancho-95">
                        <div class="text-center">
                            <div class="servicio-main-icon">
                                <i class="fas fa-seedling"></i>
                            </div>
                            <h2 class="agro-title">Nuestros Servicios</h2>
                            <p class="agro-subtitle">
                                Conectamos el talento agrícola con las mejores oportunidades laborales del sector
                            </p>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Carrusel Container -->
            <div class="carousel-agro-container">
                <div class="carousel-track-container">
                    <div class="carousel-track">
                        <!-- Slide 1: 3 servicios para desktop -->
                        <div class="servicio-slide">
                            <div class="servicio-card-agro">
                                <div class="servicio-icon-agro servicio-icon-ubicacion">
                                    <i class="fas fa-map-marker-alt"></i>
                                </div>
                                <h5>Ubicación Precisa</h5>
                                <p>Encuentra trabajo agrícola cerca de tu ubicación con mapas interactivos y geolocalización avanzada</p>
                            </div>
                            
                            <div class="servicio-card-agro">
                                <div class="servicio-icon-agro servicio-icon-perfiles">
                                    <i class="fas fa-user-check"></i>
                                </div>
                                <h5>Perfiles Verificados</h5>
                                <p>Trabajadores y empleadores con identidad verificada para mayor seguridad y confianza</p>
                            </div>
                            
                            <div class="servicio-card-agro">
                                <div class="servicio-icon-agro servicio-icon-trabajo">
                                    <i class="fas fa-briefcase"></i>
                                </div>
                                <h5>Trabajo Temporal y Fijo</h5>
                                <p>Oportunidades laborales flexibles adaptadas a las temporadas agrícolas y necesidades del campo</p>
                            </div>
                        </div>
                        
                        <!-- Slide 2: 3 servicios restantes -->
                        <div class="servicio-slide">
                            <div class="servicio-card-agro">
                                <div class="servicio-icon-agro servicio-icon-comunicacion">
                                    <i class="fas fa-comments"></i>
                                </div>
                                <h5>Comunicación Directa</h5>
                                <p>Chat integrado para comunicación directa entre trabajadores y empleadores sin intermediarios</p>
                            </div>
                            
                            <div class="servicio-card-agro">
                                <div class="servicio-icon-agro servicio-icon-pagos">
                                    <i class="fas fa-shield-alt"></i>
                                </div>
                                <h5>Pagos Seguros</h5>
                                <p>Sistema de pagos protegido con garantías para empleadores y trabajadores del sector agrícola</p>
                            </div>
                            
                            <div class="servicio-card-agro">
                                <div class="servicio-icon-agro servicio-icon-horarios">
                                    <i class="fas fa-clock"></i>
                                </div>
                                <h5>Horarios Flexibles</h5>
                                <p>Adaptabilidad a los ciclos de cultivo y las necesidades específicas de cada establecimiento</p>
                            </div>
                        </div>
                        
                        <!-- Slide 3: ¿Cómo Funciona? -->
                        <div class="servicio-slide">
                            <div class="como-funciona-wrapper">
                                <!-- Header centralizado -->
                                <div class="como-funciona-header">
                                    <div class="servicio-icon-agro servicio-icon-funciona">
                                        <i class="fas fa-question-circle"></i>
                                    </div>
                                    <h2 class="como-funciona-title">¿Cómo Funciona?</h2>
                                    <p class="como-funciona-subtitle">Simple, rápido y efectivo</p>
                                </div>
                                
                                <!-- Cards para trabajadores y empleadores -->
                                <div class="como-funciona-cards">
                                    <!-- Para Trabajadores -->
                                    <div class="como-funciona-card como-funciona-trabajadores">
                                        <h4 class="como-funciona-card-title">Para Trabajadores</h4>
                                        <div class="como-funciona-steps">
                                            <div class="como-funciona-step">
                                                <span class="como-funciona-num funciona-num-trabajador">1</span>
                                                <div class="como-funciona-content">
                                                    <span class="como-funciona-step-title">Regístrate y Crea tu Perfil</span>
                                                    <span class="como-funciona-step-desc">Completa tu información personal, experiencia y habilidades</span>
                                                </div>
                                            </div>
                                            <div class="como-funciona-step">
                                                <span class="como-funciona-num funciona-num-trabajador">2</span>
                                                <div class="como-funciona-content">
                                                    <span class="como-funciona-step-title">Busca Ofertas de Trabajo</span>
                                                    <span class="como-funciona-step-desc">Explora trabajos disponibles en tu área geográfica</span>
                                                </div>
                                            </div>
                                            <div class="como-funciona-step">
                                                <span class="como-funciona-num funciona-num-trabajador">3</span>
                                                <div class="como-funciona-content">
                                                    <span class="como-funciona-step-title">Aplica y Conecta</span>
                                                    <span class="como-funciona-step-desc">Envía tu solicitud y conecta directamente con empleadores</span>
                                                </div>
                                            </div>
                                            <div class="como-funciona-step">
                                                <span class="como-funciona-num funciona-num-trabajador">4</span>
                                                <div class="como-funciona-content">
                                                    <span class="como-funciona-step-title">Trabaja y Recibe Pago</span>
                                                    <span class="como-funciona-step-desc">Completa el trabajo y recibe tu pago de forma segura</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Para Empleadores -->
                                    <div class="como-funciona-card como-funciona-empleadores">
                                        <h4 class="como-funciona-card-title">Para Empleadores</h4>
                                        <div class="como-funciona-steps">
                                            <div class="como-funciona-step">
                                                <span class="como-funciona-num funciona-num-empleador">1</span>
                                                <div class="como-funciona-content">
                                                    <span class="como-funciona-step-title">Crea tu Cuenta Empresarial</span>
                                                    <span class="como-funciona-step-desc">Registra tu empresa y verifica tu información</span>
                                                </div>
                                            </div>
                                            <div class="como-funciona-step">
                                                <span class="como-funciona-num funciona-num-empleador">2</span>
                                                <div class="como-funciona-content">
                                                    <span class="como-funciona-step-title">Publica Ofertas de Trabajo</span>
                                                    <span class="como-funciona-step-desc">Describe el trabajo, ubicación y requisitos necesarios</span>
                                                </div>
                                            </div>
                                            <div class="como-funciona-step">
                                                <span class="como-funciona-num funciona-num-empleador">3</span>
                                                <div class="como-funciona-content">
                                                    <span class="como-funciona-step-title">Revisa Candidatos</span>
                                                    <span class="como-funciona-step-desc">Examina perfiles y selecciona a los mejores candidatos</span>
                                                </div>
                                            </div>
                                            <div class="como-funciona-step">
                                                <span class="como-funciona-num funciona-num-empleador">4</span>
                                                <div class="como-funciona-content">
                                                    <span class="como-funciona-step-title">Contrata y Supervisa</span>
                                                    <span class="como-funciona-step-desc">Contrata trabajadores y supervisa el progreso del trabajo</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Controles de navegación -->
                <nav class="carousel-nav" aria-label="Navegación del carrusel">
                    <button class="carousel-btn carousel-btn--prev" aria-label="Servicios anteriores">
                        <i class="fas fa-chevron-left"></i>
                    </button>
                    <button class="carousel-btn carousel-btn--next" aria-label="Siguientes servicios">
                        <i class="fas fa-chevron-right"></i>
                    </button>
                </nav>
                
                <!-- Indicadores -->
                <div class="carousel-indicators" role="tablist" aria-label="Indicadores de servicios">
                    <button class="carousel-indicator active" 
                            data-slide="0" 
                            aria-label="Grupo de servicios 1"
                            role="tab"
                            aria-selected="true"></button>
                    <button class="carousel-indicator" 
                            data-slide="1" 
                            aria-label="Grupo de servicios 2"
                            role="tab"
                            aria-selected="false"></button>
                    <button class="carousel-indicator" 
                            data-slide="2" 
                            aria-label="Cómo funciona"
                            role="tab"
                            aria-selected="false"></button>
                </div>
            </div>
        </div>
    </section>
    
    <!-- Vista Pública (visible por defecto) -->
    <div id="public-view">
    <!-- Mapa Interactivo de Establecimientos/Fincas -->
    <main class="container-fluid py-5">
        <div class="row justify-content-center mb-4">
            <div class="col-12">
                <div class="card h-100 shadow-sm border-0 servicio-card servicio-card-mapa servicio-card-mapa-uva card-ancho-95">
                    <div class="card-body text-center card-ancho-95">
                        <div class="mb-3 servicio-icon servicio-icon-mapa"><i class="fas fa-map-marked-alt"></i></div>
                        <h2 class="fw-bold">Mapa Interactivo de Establecimientos/Fincas</h2>
                        <p class="mb-0">Explora la ubicación de todas las fincas y establecimientos agrícolas registrados en nuestra plataforma</p>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Mapa Principal de Establecimientos -->
        <div class="row justify-content-center">
            <div class="col-12">
                <div id="main-map" class="my-3 card-ancho-95">
                    <!-- El mapa se cargará aquí -->
                    <div id="map-loading">
                        <div class="spinner-border text-primary" role="status">
                            <span class="visually-hidden">Cargando mapa...</span>
                        </div>
                        <p class="mt-2">Cargando mapa...</p>
                    </div>
                </div>
                
                <!-- Información de ubicación -->
                <div id="ubicacion-info" class="alert alert-info d-none">
                    <h6><i class="fas fa-info-circle"></i> Información de Ubicación</h6>
                    <p id="ubicacion-detalles" class="mb-0"></p>
                </div>
            </div>
        </div>
    </main>

    <!-- Ofertas Disponibles -->
    <main id="ofertas-disponibles" class="container-fluid py-5">
        <div class="row justify-content-center mb-4">
            <div class="col-12">
                <div class="card h-100 shadow-sm border-0 servicio-card servicio-card-ofertas card-ancho-95">
                    <div class="card-body text-center">
                        <div class="mb-1 servicio-icon servicio-icon-ofertas"><i class="fas fa-briefcase"></i></div>
                        <h2 class="fw-bold">Ofertas Disponibles</h2>
                        <p class="mb-0">Descubre oportunidades laborales en el sector agrícola</p>
                        <div class="mt-1">
                            <span id="contador-ofertas-publicas" class="badge bg-success fs-6">Cargando ofertas...</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Filtros de Ofertas Públicas -->
        <div class="row justify-content-center mb-4">
            <div class="col-lg-10 col-xl-9">
                <div class="card border-0 ofertas-filtros-container">
                    <div class="card-body">
                        <h4 class="text-center mb-4 fw-bold">
                            <i class="fas fa-sort me-2"></i>ORDENAR POR
                        </h4>
                        <div class="row g-3 align-items-end">
                            <!-- Filtro por Puesto -->
                            <div class="col-md-5">
                                <label for="filtro-puesto-publico" class="form-label">
                                    <i class="fas fa-briefcase"></i>
                                    Filtrar por puesto
                                </label>
                                <select class="form-select" id="filtro-puesto-publico">
                                    <option value="">Todos los puestos</option>
                                    <option value="PODADOR/ATADOR">Podador/Atador</option>
                                    <option value="COSECHADOR">Cosechador</option>
                                    <option value="TRACTORISTA">Tractorista</option>
                                    <option value="CAPATAZ">Capataz</option>
                                    <option value="VIÑATERO">Viñatero</option>
                                    <option value="JORNALERO">Jornalero</option>
                                    <option value="SUPERVISOR">Supervisor</option>
                                </select>
                            </div>
                            
                            <!-- Filtro por Estado -->
                            <div class="col-md-4">
                                <label class="form-label" for="filtro-estado-oferta">
                                    <i class="fas fa-filter"></i>
                                    Estado de oferta
                                </label>
                                <select class="form-select" id="filtro-estado-oferta" title="Filtrar ofertas por estado">
                                    <option value="">Todas</option>
                                    <option value="vigente" selected>Vigentes</option>
                                    <option value="vencida">Vencidas</option>
                                </select>
                            </div>

                            <!-- Limpiar filtros -->
                            <div class="col-md-3">
                                <button type="button" class="btn btn-outline-secondary w-100" id="btn-limpiar-filtros">
                                    <i class="fas fa-eraser me-1"></i>
                                    Limpiar filtros
                                </button>
                            </div>

                            <!-- Botones de ordenamiento -->
                            <div class="col-md-12 mt-3">
                                <div class="d-flex gap-2 flex-wrap">
                                    <button type="button" class="btn btn-outline-dark flex-fill" id="btn-ordenar-fecha">
                                        <i class="fas fa-calendar-alt me-1"></i>
                                        Ordenar por fecha
                                        <i class="fas fa-sort ms-1"></i>
                                    </button>
                                    <button type="button" class="btn btn-outline-dark flex-fill" id="btn-ordenar-cercania">
                                        <i class="fas fa-map-marker-alt me-1"></i>
                                        Ordenar por cercanía
                                    </button>
                                </div>
                                <div id="ordenamiento-info" class="text-muted text-center mt-2 small ordenamiento-info-hidden">
                                    <!-- Texto descriptivo del ordenamiento activo -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>        <!-- Container de Ofertas -->
        <div class="row justify-content-center" style="width: 95%; margin: 0 auto;">
            <div class="col-12">
                <div class="row" id="ofertas-publicas-container">
                    <!-- Las ofertas se cargarán aquí dinámicamente -->
                    <div class="col-12 text-center py-5 ofertas-loading-container">
                        <div class="spinner-border text-primary" role="status" aria-label="Cargando ofertas">
                            <span class="visually-hidden">Cargando ofertas...</span>
                        </div>
                        <p class="mt-3">Preparando sistema de ofertas laborales...</p>
                        <small class="text-muted">Conectando con base de datos de empleos agrícolas</small>
                    </div>
                </div>
            </div>
        </div>
        </div>
    </main>

    <!-- Main Content -->
    </div> <!-- Fin de public-view -->
    
    <!-- Dashboard Modal Fullscreen -->
    <div class="modal fade" id="dashboardOffcanvas" tabindex="-1" aria-labelledby="dashboardOffcanvasLabel" aria-hidden="true">
        <div class="modal-dialog modal-fullscreen">
            <div class="modal-content bg-black">
                <div class="modal-header bg-gradient-primary border-0">
                    <h4 class="modal-title text-white fw-bold" id="dashboardOffcanvasLabel">
                        <i class="fas fa-tachometer-alt me-3"></i>Panel de Control Empresarial
                    </h4>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Cerrar Dashboard"></button>
                </div>
                <div class="modal-body bg-black text-white p-0 overflow-auto" id="dashboard-content">
                    <!-- El contenido se carga dinámicamente desde JavaScript -->
                    <div class="loading-container d-flex justify-content-center align-items-center">
                        <div class="text-center">
                            <div class="spinner-border text-primary mb-3" role="status">
                                <span class="visually-hidden">Cargando...</span>
                            </div>
                            <h5 class="text-white">Cargando Panel de Control...</h5>
                            <p class="text-muted">Preparando su dashboard empresarial</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Modal Wizard Finca -->
    <div class="modal fade" id="wizardFincaModal" tabindex="-1" aria-labelledby="wizardFincaModalLabel" aria-hidden="true" data-bs-backdrop="static" data-bs-keyboard="false">
        <div class="modal-dialog modal-lg modal-dialog-centered modal-dialog-scrollable">
            <div class="modal-content border-secondary">
                <div class="modal-header border-secondary">
                    <h4 class="modal-title w-100 text-center fw-bold text-white" id="wizardFincaModalLabel">
                        <i class="fas fa-seedling me-2"></i>Agregar Nueva Finca
                    </h4>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Cerrar"></button>
                </div>
                <div class="modal-body pt-3 text-white" id="wizard-content">
                    <!-- El contenido del wizard se carga dinámicamente desde JavaScript -->
                    <div class="loading-container-small">
                        <div class="spinner-border text-primary" role="status">
                            <span class="visually-hidden">Cargando...</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <style>
        /* Ajuste del modal wizard finca al 60% del ancho */
        #wizardFincaModal .modal-dialog {
            width: 60vw !important;
            max-width: 60vw !important;
            margin-left: 20vw !important;
            margin-right: 20vw !important;
        }
        
        @media (max-width: 768px) {
            #wizardFincaModal .modal-dialog {
                width: 95vw !important;
                max-width: 95vw !important;
                margin-left: 2.5vw !important;
                margin-right: 2.5vw !important;
            }
        }
    </style>
    
    <!-- Modal Selección de Especies -->
    <div class="modal fade" id="especiesModal" tabindex="-1" aria-labelledby="especiesModalLabel" aria-hidden="true" style="display: none !important;">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content bg-dark text-white">
                <div class="modal-header border-secondary">
                    <h5 class="modal-title" id="especiesModalLabel">
                        <i class="fas fa-seedling me-2 text-success"></i>
                        Seleccionar Especies Cultivadas
                    </h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-3">
                        <small class="text-info" id="especiesModalCounter">Seleccione hasta 5 especies (0/5 seleccionadas)</small>
                    </div>
                    <div class="especies-grid" id="especiesGrid">
                        <div class="text-center p-3">
                            <div class="spinner-border text-primary" role="status">
                                <span class="visually-hidden">Cargando especies...</span>
                            </div>
                            <p class="mt-2 text-muted">Cargando especies...</p>
                        </div>
                    </div>
                </div>
                <div class="modal-footer border-secondary">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                        <i class="fas fa-times me-2"></i>Cancelar
                    </button>
                    <button type="button" class="btn btn-success" id="confirmarEspecies">
                        <i class="fas fa-check me-2"></i>Confirmar Selección
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <!-- Especies Modal JS -->
    <script src="js/especies-modal.js"></script>
    <!-- Carrusel de Servicios Agrícolas JS -->
    <script src="js/servicios-carousel.js?v=1"></script>
    <!-- App JS -->
    <script src="js/app.js?v=editar-empresa-opcional"></script>

    <!-- Modal para Editar Empresa -->
    <div class="modal fade" id="modalEditarEmpresa" tabindex="-1" aria-labelledby="modalEditarEmpresaLabel" aria-hidden="true" data-bs-backdrop="static" data-bs-keyboard="false">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content bg-dark border-secondary">
                <div class="modal-header border-secondary">
                    <h5 class="modal-title text-white" id="modalEditarEmpresaLabel">
                        <i class="fas fa-building me-2 text-success"></i>
                        Editar Datos de la Empresa
                    </h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Cerrar"></button>
                </div>
                <div class="modal-body">
                    <form id="formEditarEmpresa" novalidate>
                        <!-- Razón Social -->
                        <div class="mb-3">
                            <label for="editRazonSocial" class="form-label text-white">
                                <i class="fas fa-building me-2"></i>Razón Social
                            </label>
                            <input type="text" class="form-control bg-dark text-white border-secondary" 
                                   id="editRazonSocial" name="razonSocial" 
                                   placeholder="Deje en blanco si no desea cambiar" 
                                   maxlength="255">
                            <small class="form-text text-muted">Opcional. Máximo 255 caracteres.</small>
                        </div>

                        <!-- Nueva Contraseña -->
                        <div class="mb-3">
                            <label for="editContrasenia" class="form-label text-white">
                                <i class="fas fa-lock me-2"></i>Nueva Contraseña
                            </label>
                            <input type="password" class="form-control bg-dark text-white border-secondary" 
                                   id="editContrasenia" name="contrasenia" 
                                   placeholder="Deje en blanco si no desea cambiar" 
                                   minlength="6">
                            <div class="invalid-feedback">La contraseña debe tener al menos 6 caracteres.</div>
                            <small class="form-text text-muted">Opcional. Mínimo 6 caracteres si la ingresa.</small>
                        </div>

                        <!-- Confirmar Contraseña -->
                        <div class="mb-3">
                            <label for="editContraseniaConfirmar" class="form-label text-white">
                                <i class="fas fa-lock me-2"></i>Confirmar Contraseña
                            </label>
                            <input type="password" class="form-control bg-dark text-white border-secondary" 
                                   id="editContraseniaConfirmar" 
                                   placeholder="Confirme la nueva contraseña" 
                                   minlength="6">
                            <div class="invalid-feedback">Las contraseñas deben coincidir.</div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer border-secondary">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                        <i class="fas fa-times me-2"></i>Cancelar
                    </button>
                    <button type="button" class="btn btn-success" onclick="guardarEdicionEmpresa()">
                        <i class="fas fa-save me-2"></i>Guardar Cambios
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal para Editar Establecimiento -->
    <div class="modal fade" id="editarEstablecimientoModal" tabindex="-1" aria-labelledby="editarEstablecimientoModalLabel" aria-hidden="true" data-bs-backdrop="static" data-bs-keyboard="false">
        <div class="modal-dialog modal-lg modal-dialog-centered modal-dialog-scrollable">
            <div class="modal-content text-white" style="background: #004225 !important; border: 2px solid #006837 !important;">
                <div class="modal-header" style="background: #004225 !important; border-bottom: 1px solid #006837 !important;">
                    <h5 class="modal-title text-white" id="editarEstablecimientoModalLabel" style="text-transform: uppercase !important;">
                        <i class="fas fa-edit me-2 text-warning"></i>
                        Editar Establecimiento
                    </h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Cerrar" style="background: transparent !important; box-shadow: none !important; opacity: 1 !important;"></button>
                </div>
                <div class="modal-body" style="background: #004225 !important;">
                    <form id="formEditarEstablecimiento" novalidate>
                        <!-- Hidden input para ID -->
                        <input type="hidden" id="editEstabIdEstablecimiento" name="idEstablecimiento">

                        <!-- Nombre del Establecimiento -->
                        <div class="mb-3">
                            <label for="editEstabNombre" class="form-label text-white">
                                <i class="fas fa-warehouse me-2"></i>Nombre del Establecimiento
                                <span class="text-danger">*</span>
                            </label>
                            <input type="text" class="form-control bg-dark text-white border-secondary" 
                                   id="editEstabNombre" name="nombreEstablecimiento" 
                                   placeholder="Ej: Finca Los Olivos" 
                                   maxlength="25" required
                                   style="text-transform: uppercase;">
                            <div class="invalid-feedback">El nombre es obligatorio (máx. 25 caracteres).</div>
                        </div>

                        <!-- Calle -->
                        <div class="mb-3">
                            <label for="editEstabCalle" class="form-label text-white">
                                <i class="fas fa-road me-2"></i>Calle
                                <span class="text-danger">*</span>
                            </label>
                            <input type="text" class="form-control bg-dark text-white border-secondary" 
                                   id="editEstabCalle" name="calle" 
                                   placeholder="Ej: Ruta Provincial 82" 
                                   maxlength="25" required
                                   style="text-transform: uppercase;">
                            <div class="invalid-feedback">La calle es obligatoria (máx. 25 caracteres).</div>
                        </div>

                        <!-- Numeración -->
                        <div class="mb-3">
                            <label for="editEstabNumeracion" class="form-label text-white">
                                <i class="fas fa-hashtag me-2"></i>Numeración
                                <span class="text-danger">*</span>
                            </label>
                            <input type="text" class="form-control bg-dark text-white border-secondary" 
                                   id="editEstabNumeracion" name="numeracion" 
                                   placeholder="Ej: 15" 
                                   maxlength="5" required
                                   pattern="[0-9]+"
                                   oninput="this.value = this.value.replace(/[^0-9]/g, '')">
                            <div class="invalid-feedback">La numeración es obligatoria (máx. 5 caracteres).</div>
                        </div>

                        <!-- Código Postal -->
                        <div class="mb-3">
                            <label for="editEstabCodigoPostal" class="form-label text-white">
                                <i class="fas fa-mail-bulk me-2"></i>Código Postal
                                <span class="text-danger">*</span>
                            </label>
                            <input type="text" class="form-control bg-dark text-white border-secondary" 
                                   id="editEstabCodigoPostal" name="codigoPostal" 
                                   placeholder="Ej: 5505" 
                                   maxlength="4" pattern="[0-9]{4}" required
                                   oninput="this.value = this.value.replace(/[^0-9]/g, '')">
                            <div class="invalid-feedback">Debe ser exactamente 4 dígitos.</div>
                        </div>

                        <!-- Distrito -->
                        <div class="mb-3">
                            <label for="editEstabDistrito" class="form-label text-white">
                                <i class="fas fa-map-marked-alt me-2"></i>Distrito
                                <span class="text-danger">*</span>
                            </label>
                            <select class="form-select bg-dark text-white border-secondary" 
                                    id="editEstabDistrito" name="idDistrito" required>
                                <option value="">Cargando distritos...</option>
                            </select>
                            <div class="invalid-feedback">Debe seleccionar un distrito.</div>
                        </div>

                        <!-- Especies -->
                        <div class="mb-3">
                            <label class="form-label text-white">
                                <i class="fas fa-seedling me-2"></i>Especies Cultivadas
                                <span class="text-danger">*</span>
                            </label>
                            
                            <!-- Hidden input to store selected species IDs -->
                            <input type="hidden" id="editEstabEspeciesIds" name="idsEspecies" required>
                            
                            <!-- Button to toggle dropdown -->
                            <button type="button" class="btn btn-success w-100 mb-2" 
                                    onclick="toggleDropdownEspecies(event)" 
                                    id="editEstabEspeciesBtn">
                                <i class="fas fa-seedling me-2"></i>
                                <span id="editEstabEspeciesBtnText">Seleccionar Especies (0/5)</span>
                                <i class="fas fa-chevron-down ms-2" id="editEstabEspeciesChevron"></i>
                            </button>
                            
                            <!-- Dropdown expandible (oculto por defecto) -->
                            <div id="editEstabEspeciesDropdown" class="especies-dropdown" style="display: none;">
                                <div class="especies-dropdown-grid" id="editEstabEspeciesGrid">
                                    <div class="text-center p-3">
                                        <div class="spinner-border spinner-border-sm text-success" role="status"></div>
                                        <small class="d-block mt-2 text-muted">Cargando especies...</small>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Display de especies seleccionadas -->
                            <div class="especies-seleccionadas mt-2" id="editEstabEspeciesDisplay">
                                <small class="text-info">No hay especies seleccionadas</small>
                            </div>
                            
                            <div class="invalid-feedback">Debe seleccionar al menos una especie.</div>
                        </div>

                        <!-- Ubicación -->
                        <div class="mb-3">
                            <label class="form-label text-white">
                                <i class="fas fa-map-marker-alt me-2"></i>Ubicación Geográfica
                                <span class="text-danger">*</span>
                            </label>
                            <div class="row g-2">
                                <div class="col-md-6">
                                    <input type="number" class="form-control bg-dark text-white border-secondary" 
                                           id="editEstabLatitud" name="latitud" 
                                           placeholder="Latitud" 
                                           step="0.000001" min="-90" max="90" required>
                                    <div class="invalid-feedback">Latitud entre -90 y 90.</div>
                                </div>
                                <div class="col-md-6">
                                    <input type="number" class="form-control bg-dark text-white border-secondary" 
                                           id="editEstabLongitud" name="longitud" 
                                           placeholder="Longitud" 
                                           step="0.000001" min="-180" max="180" required>
                                    <div class="invalid-feedback">Longitud entre -180 y 180.</div>
                                </div>
                            </div>
                            <button type="button" class="btn mt-2" style="background-color: #5F021C; border-color: #5F021C; color: white;" onclick="usarUbicacionActualParaEdicion()">
                                <i class="fas fa-location-arrow me-2"></i>Usar mi ubicación actual
                            </button>
                        </div>

                        <!-- Mapa de Ubicación -->
                        <div class="mb-3">
                            <label class="form-label text-white">
                                <i class="fas fa-map-marked-alt me-2"></i>Vista Previa del Mapa
                            </label>
                            <div id="mapEditarEstablecimiento" class="map-preview-editar"></div>
                            <small class="form-text text-muted">El mapa se actualizará automáticamente con la ubicación del establecimiento.</small>
                        </div>
                    </form>
                </div>
                <div class="modal-footer" style="background: #004225 !important; border-top: 1px solid #006837 !important;">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                        <i class="fas fa-times me-2"></i>Cancelar
                    </button>
                    <button type="button" class="btn btn-success" onclick="guardarEdicionEstablecimiento()">
                        <i class="fas fa-save me-2"></i>Guardar Cambios
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal para Crear/Editar Oferta de Trabajo -->
    <div class="modal fade" id="modalOfertaTrabajo" tabindex="-1" aria-labelledby="modalOfertaTrabajoLabel" aria-hidden="true" data-bs-backdrop="static" data-bs-keyboard="false">
        <div class="modal-dialog modal-lg modal-dialog-centered modal-dialog-scrollable">
            <div class="modal-content bg-dark border-secondary">
                <div class="modal-header border-secondary">
                    <h5 class="modal-title text-white" id="modalOfertaTrabajoLabel">
                        <i class="fas fa-briefcase me-2 text-info"></i>
                        <span id="modalOfertaTitulo">Nueva Oferta de Trabajo</span>
                    </h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Cerrar"></button>
                </div>
                <div class="modal-body">
                    <form id="formOfertaTrabajo" novalidate>
                        <!-- Información básica -->
                        <div class="row mb-4">
                            <div class="col-12">
                                <h6 class="text-info mb-3" style="text-transform: uppercase !important;">
                                    <i class="fas fa-info-circle me-2"></i>INFORMACIÓN BÁSICA
                                </h6>
                            </div>
                        </div>
                        
                        <div class="row">
                            <div class="col-md-8 mb-3">
                                <label for="ofertaTitulo" class="form-label text-white">
                                    <i class="fas fa-heading me-1"></i>Título de la Oferta *
                                </label>
                                <input type="text" class="form-control" id="ofertaTitulo" name="titulo" required
                                       placeholder="Ej: Operario Agrícola - Cosecha de Uva" maxlength="100">
                                <div class="invalid-feedback"></div>
                                <small class="text-muted">Título claro y descriptivo (10-100 caracteres)</small>
                            </div>
                            <div class="col-md-4 mb-3">
                                <label for="ofertaEstado" class="form-label text-white">
                                    <i class="fas fa-flag me-1"></i>Estado
                                </label>
                                <select class="form-select" id="ofertaEstado" name="estado">
                                    <option value="BORRADOR">📝 Borrador</option>
                                    <option value="ACTIVA" selected>✅ Activa</option>
                                    <option value="PAUSADA">⏸️ Pausada</option>
                                </select>
                            </div>
                        </div>

                        <div class="mb-3">
                            <label for="ofertaDescripcion" class="form-label text-white">
                                <i class="fas fa-align-left me-1"></i>Descripción del Trabajo *
                            </label>
                            <textarea class="form-control" id="ofertaDescripcion" name="descripcion" rows="4" required
                                      placeholder="Describe las tareas, responsabilidades y lo que se busca en el candidato..." maxlength="2000"></textarea>
                            <div class="invalid-feedback"></div>
                            <small class="text-muted">Descripción detallada (50-2000 caracteres)</small>
                        </div>

                        <!-- Detalles laborales -->
                        <div class="row mb-4">
                            <div class="col-12">
                                <h6 class="text-info mb-3" style="text-transform: uppercase !important;">
                                    <i class="fas fa-briefcase me-2"></i>DETALLES LABORALES
                                </h6>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="ofertaModalidad" class="form-label text-white">
                                    <i class="fas fa-clock me-1"></i>Modalidad de Trabajo *
                                </label>
                                <select class="form-select" id="ofertaModalidad" name="modalidadTrabajo" required>
                                    <option value="">Seleccionar modalidad</option>
                                    <option value="TIEMPO_COMPLETO">🕐 Tiempo Completo</option>
                                    <option value="MEDIO_TIEMPO">🕒 Medio Tiempo</option>
                                    <option value="TEMPORAL">📅 Temporal/Estacional</option>
                                    <option value="POR_HORAS">⏰ Por Horas</option>
                                    <option value="COSECHA">🍇 Solo Cosecha</option>
                                </select>
                                <div class="invalid-feedback"></div>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="ofertaSalario" class="form-label text-white">
                                    <i class="fas fa-dollar-sign me-1"></i>Salario (ARS)
                                </label>
                                <input type="number" class="form-control" id="ofertaSalario" name="salario" 
                                       placeholder="Ej: 150000" min="0" max="10000000" step="1000">
                                <div class="invalid-feedback"></div>
                                <small class="text-muted">Salario mensual aproximado (opcional)</small>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-8 mb-3">
                                <label for="ofertaUbicacion" class="form-label text-white">
                                    <i class="fas fa-map-marker-alt me-1"></i>Ubicación *
                                </label>
                                <input type="text" class="form-control" id="ofertaUbicacion" name="ubicacion" required
                                       placeholder="Ej: Mendoza, Maipú - Finca Los Álamos" maxlength="100">
                                <div class="invalid-feedback"></div>
                                <small class="text-muted">Ciudad, departamento o zona específica</small>
                            </div>
                            <div class="col-md-4 mb-3">
                                <label for="ofertaFechaLimite" class="form-label text-white">
                                    <i class="fas fa-calendar-alt me-1"></i>Fecha Límite
                                </label>
                                <input type="date" class="form-control" id="ofertaFechaLimite" name="fechaLimite">
                                <div class="invalid-feedback"></div>
                                <small class="text-muted">Hasta cuándo postular</small>
                            </div>
                        </div>

                        <!-- Requisitos y contacto -->
                        <div class="row mb-4">
                            <div class="col-12">
                                <h6 class="text-info mb-3" style="text-transform: uppercase !important;">
                                    <i class="fas fa-check-circle me-2"></i>REQUISITOS Y CONTACTO
                                </h6>
                            </div>
                        </div>

                        <div class="mb-3">
                            <label for="ofertaRequisitos" class="form-label text-white">
                                <i class="fas fa-list-check me-1"></i>Requisitos del Candidato
                            </label>
                            <textarea class="form-control" id="ofertaRequisitos" name="requisitos" rows="3"
                                      placeholder="Ej: Experiencia previa en agricultura, disponibilidad de horarios, vehículo propio..." maxlength="1000"></textarea>
                            <div class="invalid-feedback"></div>
                            <small class="text-muted">Lista los requisitos más importantes (opcional)</small>
                        </div>

                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="ofertaContactoNombre" class="form-label text-white">
                                    <i class="fas fa-user me-1"></i>Nombre de Contacto
                                </label>
                                <input type="text" class="form-control" id="ofertaContactoNombre" name="contactoNombre"
                                       placeholder="Ej: Juan Pérez" maxlength="100">
                                <div class="invalid-feedback"></div>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="ofertaContactoTelefono" class="form-label text-white">
                                    <i class="fas fa-phone me-1"></i>Teléfono de Contacto
                                </label>
                                <input type="tel" class="form-control" id="ofertaContactoTelefono" name="contactoTelefono"
                                       placeholder="Ej: 261-123-4567" maxlength="20">
                                <div class="invalid-feedback"></div>
                            </div>
                        </div>

                        <!-- Campo oculto para ID (en caso de edición) -->
                        <input type="hidden" id="ofertaId" name="id">
                    </form>
                </div>
                <div class="modal-footer border-secondary">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                        <i class="fas fa-times me-2"></i>Cancelar
                    </button>
                    <button type="button" class="btn btn-outline-primary" onclick="guardarBorradorOferta()">
                        <i class="fas fa-save me-2"></i>Guardar Borrador
                    </button>
                    <button type="button" class="btn btn-success" onclick="publicarOferta()">
                        <i class="fas fa-check me-2"></i>Publicar Oferta
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal para Ver Detalles de Oferta -->
    <div class="modal fade" id="modalVerOferta" tabindex="-1" aria-labelledby="modalVerOfertaLabel" aria-hidden="true">
        <div class="modal-dialog modal-xl modal-dialog-centered modal-dialog-scrollable">
            <div class="modal-content bg-dark border-secondary">
                <div class="modal-header border-secondary">
                    <h5 class="modal-title text-white" id="modalVerOfertaLabel">
                        <i class="fas fa-eye me-2 text-info"></i>Detalles de la Oferta
                    </h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Cerrar"></button>
                </div>
                <div class="modal-body" id="contenidoVerOferta">
                    <!-- Contenido dinámico -->
                    <div class="text-center py-5">
                        <div class="spinner-border text-info" role="status">
                            <span class="visually-hidden">Cargando...</span>
                        </div>
                        <p class="text-white mt-3">Cargando detalles de la oferta...</p>
                    </div>
                </div>
                <div class="modal-footer border-secondary">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                        <i class="fas fa-times me-2"></i>Cerrar
                    </button>
                    <button type="button" class="btn btn-warning" onclick="editarOfertaDesdeModal()">
                        <i class="fas fa-edit me-2"></i>Editar
                    </button>
                    <button type="button" class="btn btn-info" onclick="verPostulacionesOferta()">
                        <i class="fas fa-users me-2"></i>Ver Postulaciones
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de Postulación -->
    <div class="modal fade" id="modalPostulacion" tabindex="-1" aria-labelledby="modalPostulacionLabel" aria-hidden="true">
        <div class="modal-dialog modal-xl modal-dialog-scrollable">
            <div class="modal-content text-white" style="background: #004225 !important; border: 2px solid #006837 !important;">
                <!-- Header -->
                <div class="modal-header" style="background: #004225 !important; border-bottom: 1px solid #006837 !important;">
                    <h5 class="modal-title" id="modalPostulacionLabel">
                        <i class="fas fa-file-signature me-2 text-primary"></i>
                        Postularse a Oferta Laboral
                    </h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                
                <!-- Body -->
                <div class="modal-body" style="background: #004225 !important;">
                    <form id="form-postulacion" novalidate>
                        <div class="row">
                            <!-- Columna Izquierda: Formulario -->
                            <div class="col-md-6">
                                <h6 class="mb-3 text-info">
                                    <i class="fas fa-user me-2"></i>Datos Personales
                                </h6>
                                
                                <!-- DNI -->
                                <div class="mb-3">
                                    <label for="dni-postulacion" class="form-label">DNI *</label>
                                    <input type="text" 
                                           class="form-control" 
                                           id="dni-postulacion" 
                                           name="dni" 
                                           placeholder="Sin puntos ni guiones"
                                           maxlength="8"
                                           inputmode="numeric"
                                           oninput="this.value = this.value.replace(/[^0-9]/g, '')">
                                </div>
                                
                                <!-- Apellido -->
                                <div class="mb-3">
                                    <label for="apellido-postulacion" class="form-label">Apellido *</label>
                                    <input type="text" 
                                           class="form-control" 
                                           id="apellido-postulacion" 
                                           name="apellido" 
                                           placeholder="Ingrese su apellido"
                                           style="text-transform: uppercase;"
                                           oninput="this.value = this.value.replace(/[^a-záéíóúñA-ZÁÉÍÓÚÑ]/g, '').toUpperCase()">
                                </div>
                                
                                <!-- Nombre -->
                                <div class="mb-3">
                                    <label for="nombre-postulacion" class="form-label">Nombre *</label>
                                    <input type="text" 
                                           class="form-control" 
                                           id="nombre-postulacion" 
                                           name="nombre" 
                                           placeholder="Ingrese su nombre"
                                           style="text-transform: uppercase;"
                                           oninput="this.value = this.value.replace(/[^a-záéíóúñA-ZÁÉÍÓÚÑ]/g, '').toUpperCase()">
                                </div>
                                
                                <!-- Teléfono -->
                                <div class="mb-3">
                                    <label for="telefono-postulacion" class="form-label">Teléfono *</label>
                                    <input type="tel" 
                                           class="form-control" 
                                           id="telefono-postulacion" 
                                           name="telefono" 
                                           placeholder="Ej: +54 261 123-4567"
                                           maxlength="12"
                                           inputmode="numeric"
                                           oninput="this.value = this.value.replace(/[^0-9]/g, '')">
                                </div>
                                
                                <h6 class="mb-3 mt-4 text-info">
                                    <i class="fas fa-map-marker-alt me-2"></i>Domicilio
                                </h6>
                                
                                <!-- Calle y Numeración -->
                                <div class="row">
                                    <div class="col-md-8 mb-3">
                                        <label for="calle-postulacion" class="form-label">Calle *</label>
                                        <input type="text" 
                                               class="form-control" 
                                               id="calle-postulacion" 
                                               name="calle" 
                                               placeholder="Nombre de la calle">
                                    </div>
                                    <div class="col-md-4 mb-3">
                                        <label for="numeracion-postulacion" class="form-label">Número *</label>
                                        <input type="text" 
                                               class="form-control" 
                                               id="numeracion-postulacion" 
                                               name="numeracion" 
                                               placeholder="1234">
                                    </div>
                                </div>
                                
                                <!-- Código Postal -->
                                <div class="mb-3">
                                    <label for="codigoPostal-postulacion" class="form-label">Código Postal *</label>
                                    <input type="text" 
                                           class="form-control" 
                                           id="codigoPostal-postulacion" 
                                           name="codigoPostal" 
                                           maxlength="4"
                                           placeholder="5500"
                                           inputmode="numeric"
                                           oninput="this.value = this.value.replace(/[^0-9]/g, '')">
                                </div>
                                
                                <!-- Departamento -->
                                <div class="mb-3">
                                    <label for="departamento-postulacion" class="form-label">Departamento *</label>
                                    <select class="form-select" 
                                            id="departamento-postulacion" 
                                            name="departamento">
                                        <option value="">Cargando...</option>
                                    </select>
                                </div>
                                
                                <!-- Distrito -->
                                <div class="mb-3">
                                    <label for="distrito-postulacion" class="form-label">Distrito *</label>
                                    <select class="form-select" 
                                            id="distrito-postulacion" 
                                            name="distrito" 
                                            disabled>
                                        <option value="">Seleccione primero un departamento</option>
                                    </select>
                                </div>
                                
                                <!-- Latitud y Longitud (readonly) -->
                                <div class="row">
                                    <div class="col-md-6 mb-3">
                                        <label for="latitud-postulacion" class="form-label">Latitud *</label>
                                        <input type="text" 
                                               class="form-control" 
                                               id="latitud-postulacion" 
                                               name="latitud" 
                                               readonly
                                               placeholder="Marque en el mapa">
                                    </div>
                                    <div class="col-md-6 mb-3">
                                        <label for="longitud-postulacion" class="form-label">Longitud *</label>
                                        <input type="text" 
                                               class="form-control" 
                                               id="longitud-postulacion" 
                                               name="longitud" 
                                               readonly
                                               placeholder="Marque en el mapa">
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Columna Derecha: Mapa -->
                            <div class="col-md-6">
                                <h6 class="mb-3 text-info">
                                    <i class="fas fa-map-marked-alt me-2"></i>Marque su Ubicación
                                </h6>
                                <p class="text-muted small mb-3">
                                    Haga click en el mapa o arrastre el marcador para indicar su ubicación exacta.
                                </p>
                                
                                <div class="position-relative">
                                    <div id="mapa-postulacion" style="height: 550px; border-radius: 8px; border: 1px solid #444;"></div>
                                    <button type="button" 
                                            class="btn btn-sm btn-primary position-absolute top-0 end-0 m-2" 
                                            onclick="obtenerUbicacionActual()"
                                            style="z-index: 1000;">
                                        <i class="fas fa-crosshairs me-1"></i>
                                        Usar mi ubicación
                                    </button>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
                
                <!-- Footer -->
                <div class="modal-footer" style="background: #004225 !important; border-top: 1px solid #006837 !important;">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                        <i class="fas fa-times me-2"></i>Cancelar
                    </button>
                    <button type="button" 
                            class="btn btn-primary" 
                            id="btn-enviar-postulacion"
                            onclick="enviarPostulacion()">
                        <i class="fas fa-paper-plane me-2"></i>Enviar
                    </button>
                </div>
            </div>
        </div>
    </div>

    </div><!-- Cierre de #page-wrapper -->
    
    <!-- Script para DESACTIVAR validación HTML5 del formulario de postulación -->
    <script>
    document.addEventListener('DOMContentLoaded', function() {
        const form = document.getElementById('form-postulacion');
        if (form) {
            // Desactivar validación nativa COMPLETAMENTE
            form.noValidate = true;
            form.setAttribute('novalidate', 'true');
            
            // Interceptar eventos de validación del formulario
            form.addEventListener('submit', function(e) {
                e.preventDefault();
                e.stopPropagation();
                return false;
            }, true);
            
            form.addEventListener('invalid', function(e) {
                e.preventDefault();
                e.stopPropagation();
            }, true);
            
            // Desactivar validación en todos los campos
            const campos = form.querySelectorAll('input, select, textarea');
            campos.forEach(campo => {
                campo.removeAttribute('required');
                campo.removeAttribute('pattern');
                campo.removeAttribute('minlength');
                campo.removeAttribute('maxlength');
                
                if (campo.setCustomValidity) {
                    campo.setCustomValidity('');
                }
                
                // Interceptar eventos invalid en cada campo
                campo.addEventListener('invalid', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                }, true);
            });
            
            // ELIMINAR todos los invalid-feedback existentes
            form.querySelectorAll('.invalid-feedback').forEach(function(fb) {
                fb.remove();
            });
            
            console.log('✅ Validación HTML5 desactivada completamente');
        }
        
        // Observer para eliminar invalid-feedback que se agreguen dinámicamente
        const observer = new MutationObserver(function(mutations) {
            mutations.forEach(function(mutation) {
                // Remover atributos de validación
                if (mutation.type === 'attributes' && mutation.target.id && 
                    mutation.target.id.includes('postulacion')) {
                    const campo = mutation.target;
                    campo.removeAttribute('required');
                    campo.removeAttribute('pattern');
                    if (campo.setCustomValidity) {
                        campo.setCustomValidity('');
                    }
                }
                
                // Eliminar nodos invalid-feedback que se agreguen
                if (mutation.type === 'childList' && mutation.addedNodes.length > 0) {
                    mutation.addedNodes.forEach(function(node) {
                        if (node.classList && node.classList.contains('invalid-feedback') && 
                            !node.classList.contains('show-error')) {
                            node.remove();
                        }
                    });
                }
            });
        });
        
        if (form) {
            observer.observe(form, {
                attributes: true,
                childList: true,
                subtree: true,
                attributeFilter: ['required', 'pattern', 'minlength']
            });
        }
    });
    </script>

</body>
</html>
