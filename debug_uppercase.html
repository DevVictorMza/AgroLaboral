<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test de Conversi√≥n Autom√°tica a May√∫sculas</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 600px;
            margin: 50px auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .test-container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .field-group {
            margin-bottom: 20px;
        }
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #333;
        }
        input {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 6px;
            font-size: 16px;
            transition: all 0.2s ease;
        }
        .uppercase-field {
            text-transform: uppercase;
            background-color: #f8f9fa;
            border-color: #007bff;
        }
        .uppercase-converting {
            background-color: #e3f2fd !important;
            border-color: #2196f3 !important;
        }
        .char-counter {
            position: absolute;
            right: 8px;
            bottom: 8px;
            font-size: 12px;
            color: #666;
            background: white;
            padding: 2px 6px;
            border-radius: 3px;
        }
        .instructions {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        .test-result {
            margin-top: 15px;
            padding: 10px;
            border-radius: 5px;
            font-weight: bold;
        }
        .success { background: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
        .error { background: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>üîß Test de Conversi√≥n Autom√°tica a May√∫sculas</h1>
        
        <div class="instructions">
            <h3>Prueba Simple:</h3>
            <ol>
                <li><strong>Escriba en min√∫sculas</strong> en los campos de prueba</li>
                <li>El texto debe convertirse autom√°ticamente a may√∫sculas</li>
                <li>Ejemplo: escriba "finca los olivos" ‚Üí debe aparecer "FINCA LOS OLIVOS"</li>
                <li>Pruebe tambi√©n copiar y pegar texto en min√∫sculas</li>
            </ol>
        </div>

        <div class="field-group" style="position: relative;">
            <label for="nombreEstablecimiento">Nombre Establecimiento (conversi√≥n autom√°tica):</label>
            <input type="text" 
                   id="nombreEstablecimiento" 
                   name="nombreEstablecimiento"
                   class="uppercase-field"
                   placeholder="Escriba aqu√≠ en min√∫sculas: finca los olivos"
                   maxlength="50">
            <div class="char-counter">0/50</div>
        </div>

        <div class="field-group" style="position: relative;">
            <label for="calle">Calle (conversi√≥n autom√°tica):</label>
            <input type="text" 
                   id="calle" 
                   name="calle"
                   class="uppercase-field"
                   placeholder="Escriba aqu√≠ en min√∫sculas: avenida libertador"
                   maxlength="25">
            <div class="char-counter">0/25</div>
        </div>

        <div class="field-group">
            <label for="campoNormal">Campo Normal (sin conversi√≥n):</label>
            <input type="text" 
                   id="campoNormal"
                   placeholder="Este campo mantiene las min√∫sculas como las escribas">
        </div>

        <div id="testResult" class="test-result" style="display: none;"></div>
    </div>

    <script>
        // Funci√≥n para agregar contador de caracteres
        function addCharacterCounter(inputId, maxLength) {
            const input = document.getElementById(inputId);
            const counter = input.parentNode.querySelector('.char-counter');
            
            function updateCounter() {
                const currentLength = input.value.length;
                counter.textContent = `${currentLength}/${maxLength}`;
                
                if (currentLength >= maxLength * 0.9) {
                    counter.style.color = '#dc3545';
                } else if (currentLength >= maxLength * 0.8) {
                    counter.style.color = '#ffc107';
                } else {
                    counter.style.color = '#666';
                }
            }
            
            input.addEventListener('input', updateCounter);
            input.addEventListener('keyup', updateCounter);
        }

        // Funci√≥n para convertir autom√°ticamente texto a may√∫sculas
        function addUppercaseConverter(inputId) {
            const input = document.getElementById(inputId);
            if (!input) {
                console.error(`Campo ${inputId} no encontrado`);
                return;
            }
            
            console.log(`üîß Configurando conversi√≥n autom√°tica para: ${inputId}`);
            
            function convertToUppercase() {
                const start = input.selectionStart;
                const end = input.selectionEnd;
                const value = input.value;
                const upperValue = value.toUpperCase();
                
                if (value !== upperValue) {
                    input.value = upperValue;
                    input.setSelectionRange(start, end);
                    
                    // Feedback visual
                    input.classList.add('uppercase-converting');
                    setTimeout(() => input.classList.remove('uppercase-converting'), 150);
                    
                    console.log(`‚úÖ Convertido: "${value}" ‚Üí "${upperValue}"`);
                    
                    // Mostrar resultado de la prueba
                    showTestResult(`Campo ${inputId}: Conversi√≥n exitosa "${value}" ‚Üí "${upperValue}"`);
                }
            }
            
            // M√∫ltiples event listeners para capturar toda entrada
            input.addEventListener('input', () => setTimeout(convertToUppercase, 0));
            input.addEventListener('keydown', () => setTimeout(convertToUppercase, 0));
            input.addEventListener('keyup', () => setTimeout(convertToUppercase, 0));
            input.addEventListener('paste', () => setTimeout(convertToUppercase, 10));
            input.addEventListener('change', convertToUppercase);
            
            // Configurar estilos y atributos
            input.style.textTransform = 'uppercase';
            input.setAttribute('data-uppercase', 'true');
            input.setAttribute('autocapitalize', 'characters');
            
            // Convertir valor inicial
            if (input.value) {
                input.value = input.value.toUpperCase();
            }
            
            console.log(`‚úÖ Campo ${inputId} configurado correctamente`);
        }
        
        // Funci√≥n para mostrar resultados de prueba
        function showTestResult(message) {
            const resultDiv = document.getElementById('testResult');
            resultDiv.style.display = 'block';
            resultDiv.className = 'test-result success';
            resultDiv.textContent = message;
            
            setTimeout(() => {
                resultDiv.style.display = 'none';
            }, 3000);
        }
        
        // Inicializar cuando el DOM est√© listo
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üöÄ Inicializando sistema de conversi√≥n autom√°tica...');
            
            // Configurar contadores
            addCharacterCounter('nombreEstablecimiento', 50);
            addCharacterCounter('calle', 25);
            
            // Configurar conversi√≥n autom√°tica
            addUppercaseConverter('nombreEstablecimiento');
            addUppercaseConverter('calle');
            
            console.log('‚úÖ Sistema inicializado correctamente');
            showTestResult('Sistema configurado. Pruebe escribir en min√∫sculas en los campos marcados.');
        });
        
        // Debugging adicional
        document.addEventListener('input', function(e) {
            if (e.target.getAttribute('data-uppercase') === 'true') {
                console.log(`üìù Input detectado en ${e.target.id}: "${e.target.value}"`);
            }
        });
    </script>
</body>
</html>